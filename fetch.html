<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fetch</title>
</head>
<body>
    <script>
    // Fetch comments of post ID = 1, group them by email domain
       fetch('https://jsonplaceholder.typicode.com/comments?postId=1')
       .then(response => {
        if (!response.ok) {
          throw new Error("Failed to fetch comments");
        }
        return response.json();
      })
      .then(comments => {
        const groupedByDomain = comments.reduce((groups, comment) => {
          const domain = comment.email.split("@")[1]; 
          if (!groups[domain]) {
            groups[domain] = [];
          }
          groups[domain].push(comment);
          return groups;
        }, {});
        console.log("Grouped Comments by Email Domain:");
        console.log(groupedByDomain);
      })
      .catch(error => {
        console.error("Error:", error);
      });

  // Fetch posts and display only those with more than 50 characters in the title
    fetch('https://jsonplaceholder.typicode.com/posts')
    .then(response=>{
      if(!response.ok){
        throw new Error("Failed to fetch comments");
      }
      return response.json();
    })
    .then(posts => {
      const longTitlePosts = posts.filter(post => post.title.length > 50);
      console.log("Posts with more than 50 characters in the title:");
      longTitlePosts.forEach(post => {
        console.log(`ID: ${post.id} | Title: ${post.title}`);
      });
    })
    .catch(error => {
      console.error("Error:", error);
    });

    // Fetch 5 posts in parallel using Promise.all
    const postIds = [1, 2, 3, 4, 5];
    const fetchPromises = postIds.map(id =>
       fetch('https://jsonplaceholder.typicode.com/posts')
       .then(response=>{
      if(!response.ok){
        throw new Error("Failed to fetch comments");
      }
      return response.json();
    })
  )
    Promise.all(fetchPromises)
  .then(posts => {
    console.log("5 posts fetched in parallel:");
    posts.forEach(post => {
      console.log(`ID: ${post.id} | Title: ${post.title}`);
    });
  })
    .catch(error => {
      console.error("Error:", error);
    });

    //  Fetch users and sort them by city name
    fetch('https://jsonplaceholder.typicode.com/users')
    .then(response=>{
      if(!response.ok){
        throw new Error("Failed to fetch comments");
      }
      return response.json();
    })
    .then(users =>{
      const user=users.sort((a,b)=> {
        return a.address.city.localeCompare(b.address.city);
      });
      console.log("sort by city name")
      user.forEach(user =>{
         console.log(`ID: ${user.id} | Name: ${user.name} | City: ${user.address.city}`);;
      })
    })
    .catch(error => {
      console.error("Error:", error);
    });

    // Using Async/Await â€“ Fetch comments of post with ID = 1
        async function fetchComments() {
          try {
             const response = await fetch('https://jsonplaceholder.typicode.com/comments?postId=1');
             if (!response.ok) {
              throw new Error("Failed to fetch comments");
            }
            const comments = await response.json();
            console.log("Comments for Post ID = 1:");
            comments.forEach(comment => {
              console.log(`ID: ${comment.id} | Name: ${comment.name} | Email: ${comment.email}`);
            });
          } catch (error) {
            console.error("Error:", error);
          }
        }
        fetchComments();

        //  Fetch todos and print only incomplete ones
        fetch('https://jsonplaceholder.typicode.com/todos')
        .then(response=>{
      if(!response.ok){
        throw new Error("Failed to fetch todos");
      }
      return response.json();
    })
    .then(todos => {
      const incompleteTodos = todos.filter(todo => !todo.completed);
      console.log("Incomplete Todos:");
      incompleteTodos.forEach(todo => {
        console.log(`ID: ${todo.id} | Title: ${todo.title} | Completed: ${todo.completed}`);
      });
    })
    .catch(error => {
      console.error("Error:", error);
    });

    //Delete a user with ID = 3
    fetch('https://jsonplaceholder.typicode.com/users/3', {
      method: 'DELETE', 
    })
    .then(response => {
      if (!response.ok) {
        throw new Error("Failed to delete user");
      }
      console.log("User with ID = 3 deleted successfully!");
    })
    .catch(error => {
      console.error("Error:", error);
    });

    // Update the title of post with ID = 5
    fetch('https://jsonplaceholder.typicode.com/posts/5', {
      method: 'PATCH', 
      headers: {
        'Content-Type': 'application/json'
      },
      body: JSON.stringify({
        title: "This is the updated title" 
      })
    })
    .then(response => {
      if (!response.ok) {
        throw new Error("Failed to update the post");
      }
      return response.json();
    })
    .then(updatedPost => {
      console.log("Post updated successfully:");
      console.log(`ID: ${updatedPost.id} | Title: ${updatedPost.title}`);
     })
     .catch(error => {
      console.error("Error:", error);
    });

    //Create a new todo using POST request
      fetch('https://jsonplaceholder.typicode.com/todos', {
        method: 'POST', 
        headers: {
          'Content-Type': 'application/json'
        },
        body: JSON.stringify({
          userId: 1,           
          title: "Learn Async/Await", 
          completed: false       
        })
      })
      .then(response => {
        if (!response.ok) {
          throw new Error("Failed to create todo");
        }
        return response.json();
      })
      .then(newTodo => {
        console.log("New todo created successfully:");
        console.log(newTodo);
      })
      .catch(error => {
        console.error("Error:", error);
      });

      // Fetch post with ID = 10
      fetch('https://jsonplaceholder.typicode.com/posts/10')
      .then(response => {
        if (!response.ok) {
          throw new Error("Failed to fetch the post");
        }
        return response.json();
      })
      .then(post => {
        console.log("Post with ID = 10:");
        console.log(`ID: ${post.id} | Title: ${post.title} | Body: ${post.body}`);
      })
      .catch(error => {
        console.error("Error:", error);
      });

      // Fetch all users and display their names
        fetch('https://jsonplaceholder.typicode.com/users')
        .then(response => {
          if (!response.ok) {
            throw new Error("Failed to fetch users");
          }
          return response.json();
        })
        .then(users => {
          console.log("All User Names:");
          users.forEach(user => {
            console.log(user.name);
          });
        })
        .catch(error => {
          console.error("Error:", error);
        });
</script>
</body>
</pp-html>